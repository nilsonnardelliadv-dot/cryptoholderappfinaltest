<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>CryptoPanel HOLDER - Sistema de Acumula√ß√£o de Longo Prazo</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: {
                        dark: { 950: '#05070a', 900: '#0b0e14', 800: '#151a23', 700: '#232a3b', 600: '#374151' },
                        brand: { 500: '#3b82f6', 600: '#2563eb' },
                        score: { 
                            buy: '#10b981',       // > 70
                            hold: '#f59e0b',      // 40-70
                            sell: '#ef4444',      // < 40
                            accumulate: '#22c55e', // Acumula√ß√£o ativa
                            distribute: '#ec4899' // Distribui√ß√£o
                        }
                    },
                    animation: { 
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite'
                    },
                    screens: {
                        'xs': '475px',
                        '3xl': '1920px'
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos base otimizados para Holder */
        :root {
            --color-buy: #10b981;
            --color-hold: #f59e0b;
            --color-sell: #ef4444;
            --color-accumulate: #22c55e;
            --color-distribute: #ec4899;
        }
        
        body { 
            background: linear-gradient(135deg, #05070a 0%, #0b0e14 50%, #151a23 100%);
            color: #e5e7eb; 
            min-height: 100vh;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }
        
        /* Cards com gradientes tem√°ticos */
        .card-accumulate {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(16, 185, 129, 0.02) 100%);
            border-left: 4px solid var(--color-accumulate);
        }
        
        .card-distribute {
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.02) 100%);
            border-left: 4px solid var(--color-distribute);
        }
        
        .card-hold {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(245, 158, 11, 0.02) 100%);
            border-left: 4px solid var(--color-hold);
        }
        
        /* Indicadores de volume */
        .volume-bar {
            height: 4px;
            border-radius: 2px;
            background: linear-gradient(90deg, #3b82f6 0%, #60a5fa 100%);
            position: relative;
            overflow: hidden;
        }
        
        .volume-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Progresso de acumula√ß√£o */
        .accumulation-progress {
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
            overflow: hidden;
        }
        
        .accumulation-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #22c55e 100%);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        /* Tooltip avan√ßado */
        .advanced-tooltip {
            background: linear-gradient(135deg, rgba(11, 14, 20, 0.95) 0%, rgba(23, 42, 70, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border-radius: 12px;
        }
        
        /* Anima√ß√µes */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        /* Gr√°ficos customizados */
        .sparkline {
            stroke-width: 2;
            fill: none;
        }
        
        .sparkline-up {
            stroke: #10b981;
        }
        
        .sparkline-down {
            stroke: #ef4444;
        }
        
        /* Mobile First - Breakpoints otimizados */
        @media (max-width: 640px) {
            .mobile-stack { flex-direction: column !important; }
            .mobile-full { width: 100% !important; }
            .mobile-text-center { text-align: center !important; }
            .mobile-p-3 { padding: 0.75rem !important; }
            .mobile-text-sm { font-size: 0.875rem !important; }
            .mobile-text-xs { font-size: 0.75rem !important; }
            .mobile-hidden { display: none !important; }
        }
        
        @media (max-width: 768px) {
            .table-responsive {
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .ranking-table {
                min-width: 800px;
            }
        }
        
        @media (min-width: 769px) and (max-width: 1024px) {
            .tablet-grid-2 {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }
        
        /* Scrollbar customizada */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(11, 14, 20, 0.5);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
        }
        
        /* Touch-friendly buttons */
        .touch-button {
            min-height: 44px;
            min-width: 44px;
        }
        
        /* Loading states */
        .loading-skeleton {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.05) 25%, 
                rgba(255,255,255,0.1) 50%, 
                rgba(255,255,255,0.05) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col font-sans">

    <!-- Header Principal -->
    <header class="bg-dark-900/95 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-800 shadow-xl">
        <div class="w-full mx-auto px-3 xs:px-4 sm:px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2 xs:gap-3">
                <div class="w-8 h-8 xs:w-10 xs:h-10 bg-gradient-to-br from-brand-600 to-blue-900 rounded-xl flex items-center justify-center shadow-lg">
                    <i class="fa-solid fa-diamond text-white text-sm xs:text-lg"></i>
                </div>
                <div class="mobile-text-center xs:text-left">
                    <h1 class="font-bold text-base xs:text-xl text-white tracking-tight">
                        CryptoPanel<span class="text-brand-500 font-extrabold">HOLDER</span>
                        <span class="text-[8px] xs:text-[10px] text-gray-400 bg-gray-800 rounded px-1 xs:px-2 py-0.5 xs:py-1 ml-1 xs:ml-2">v2.0</span>
                    </h1>
                    <p class="text-[10px] xs:text-xs text-gray-500 mt-0.5 xs:mt-1 mobile-hidden xs:block">Sistema de Acumula√ß√£o Estrat√©gica</p>
                </div>
            </div>
            
            <div class="flex items-center gap-2 xs:gap-3">
                <!-- Indicador de Mercado Global (mobile hidden) -->
                <div class="mobile-hidden xs:flex items-center gap-2 xs:gap-4 px-2 xs:px-4 py-1 xs:py-2 bg-dark-800 rounded-lg border border-gray-700">
                    <div class="text-center">
                        <div class="text-[8px] xs:text-[10px] text-gray-400 uppercase tracking-widest">BTC Dom</div>
                        <div class="text-xs xs:text-sm font-bold text-white">52.4%</div>
                    </div>
                    <div class="h-4 xs:h-6 w-px bg-gray-700"></div>
                    <div class="text-center">
                        <div class="text-[8px] xs:text-[10px] text-gray-400 uppercase tracking-widest">F&G</div>
                        <div class="text-xs xs:text-sm font-bold text-green-400">68</div>
                    </div>
                </div>
                
                <!-- Controles -->
                <button id="refreshData" class="touch-button p-2 bg-brand-600 hover:bg-brand-500 rounded-lg text-white transition-colors">
                    <i class="fa-solid fa-rotate text-sm xs:text-base"></i>
                </button>
                
                <button onclick="HolderUI.openSettings()" class="touch-button p-2 bg-dark-800 hover:bg-gray-700 rounded-lg border border-gray-700 transition-colors">
                    <i class="fa-solid fa-sliders text-sm xs:text-base"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Barra de Status do Mercado -->
    <div class="bg-gradient-to-r from-dark-800 to-dark-900 border-y border-gray-800">
        <div class="w-full mx-auto px-3 xs:px-4 py-2">
            <div class="grid grid-cols-2 xs:grid-cols-2 sm:grid-cols-4 gap-2 xs:gap-3 sm:gap-4">
                <div class="flex items-center justify-between p-2 xs:p-3 bg-dark-900/50 rounded-lg border border-gray-800">
                    <div>
                        <div class="text-[10px] xs:text-xs text-gray-400">Market Cap</div>
                        <div class="text-sm xs:text-lg font-bold text-white">$2.4T</div>
                    </div>
                    <div class="text-green-400 text-xs xs:text-sm">
                        <i class="fa-solid fa-arrow-up mr-0.5 xs:mr-1"></i> 3.2%
                    </div>
                </div>
                
                <div class="flex items-center justify-between p-2 xs:p-3 bg-dark-900/50 rounded-lg border border-gray-800">
                    <div>
                        <div class="text-[10px] xs:text-xs text-gray-400">24h Volume</div>
                        <div class="text-sm xs:text-lg font-bold text-white">$84.2B</div>
                    </div>
                    <div class="text-red-400 text-xs xs:text-sm">
                        <i class="fa-solid fa-arrow-down mr-0.5 xs:mr-1"></i> 1.8%
                    </div>
                </div>
                
                <div class="mobile-hidden sm:flex items-center justify-between p-2 xs:p-3 bg-dark-900/50 rounded-lg border border-gray-800">
                    <div>
                        <div class="text-[10px] xs:text-xs text-gray-400">Stablecoins</div>
                        <div class="text-sm xs:text-lg font-bold text-white">12.8%</div>
                    </div>
                    <div class="text-gray-400 text-xs xs:text-sm">
                        <i class="fa-solid fa-minus mr-0.5 xs:mr-1"></i> 0.2%
                    </div>
                </div>
                
                <div class="mobile-hidden sm:flex items-center justify-between p-2 xs:p-3 bg-dark-900/50 rounded-lg border border-gray-800">
                    <div>
                        <div class="text-[10px] xs:text-xs text-gray-400">Alt Season</div>
                        <div class="text-sm xs:text-lg font-bold text-yellow-400">74</div>
                    </div>
                    <div class="text-green-400 text-xs xs:text-sm">
                        <i class="fa-solid fa-arrow-up mr-0.5 xs:mr-1"></i> 5.1%
                    </div>
                </div>
            </div>
        </div>
    </div>

    <main class="flex-1 w-full mx-auto px-3 xs:px-4 py-4 xs:py-6">
        <!-- Se√ß√£o 1: Ranking de Oportunidades HOLDER -->
        <section class="mb-6 xs:mb-8">
            <div class="flex flex-col xs:flex-row justify-between items-start xs:items-center mb-4 gap-3 xs:gap-0">
                <h2 class="text-lg xs:text-xl font-bold text-white flex items-center gap-2">
                    <i class="fa-solid fa-ranking-star text-yellow-500 text-base xs:text-lg"></i>
                    Ranking HOLDER
                </h2>
                <div class="flex gap-2 w-full xs:w-auto">
                    <button class="flex-1 xs:flex-none px-3 py-2 xs:py-1 bg-dark-800 rounded-lg text-xs xs:text-sm border border-gray-700 hover:bg-gray-800 touch-button">
                        <i class="fa-solid fa-filter mr-1 xs:mr-2"></i>Filtrar
                    </button>
                    <button onclick="HolderExport.generateReport()" class="flex-1 xs:flex-none px-3 py-2 xs:py-1 bg-green-600 hover:bg-green-500 rounded-lg text-xs xs:text-sm touch-button">
                        <i class="fa-solid fa-file-excel mr-1 xs:mr-2"></i>Exportar
                    </button>
                </div>
            </div>
            
            <div class="bg-dark-900/50 rounded-xl border border-gray-800 overflow-hidden">
                <div class="table-responsive">
                    <table class="w-full ranking-table">
                        <thead class="bg-dark-800">
                            <tr class="text-left text-[10px] xs:text-xs uppercase text-gray-400">
                                <th class="p-2 xs:p-4">#</th>
                                <th class="p-2 xs:p-4">Ativo</th>
                                <th class="p-2 xs:p-4 text-right mobile-hidden sm:table-cell">Pre√ßo</th>
                                <th class="p-2 xs:p-4 text-center">Score</th>
                                <th class="p-2 xs:p-4 text-center mobile-hidden md:table-cell">RSI (14d)</th>
                                <th class="p-2 xs:p-4 text-center mobile-hidden lg:table-cell">Volume</th>
                                <th class="p-2 xs:p-4 text-center mobile-hidden lg:table-cell">Dist. ATH</th>
                                <th class="p-2 xs:p-4 text-center mobile-hidden md:table-cell">Market Cap</th>
                                <th class="p-2 xs:p-4 text-center">A√ß√£o</th>
                                <th class="p-2 xs:p-4 text-right">Detalhes</th>
                            </tr>
                        </thead>
                        <tbody id="holder-ranking" class="divide-y divide-gray-800">
                            <!-- Dados ser√£o inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        
        <!-- Se√ß√£o 2: Painel de An√°lise HOLDER -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-4 xs:gap-6 mb-6 xs:mb-8">
            <!-- Card 1: Top Acumula√ß√£o -->
            <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5 card-accumulate">
                <div class="flex items-center justify-between mb-3 xs:mb-4">
                    <h3 class="font-bold text-white flex items-center gap-2 text-sm xs:text-base">
                        <i class="fa-solid fa-chart-line text-green-400"></i>
                        Top Acumula√ß√£o
                    </h3>
                    <span class="text-[10px] xs:text-xs text-gray-400">Comprar</span>
                </div>
                <div id="accumulation-list" class="space-y-2 xs:space-y-3">
                    <!-- Lista gerada dinamicamente -->
                </div>
            </div>
            
            <!-- Card 2: Alerta de Distribui√ß√£o -->
            <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5 card-distribute">
                <div class="flex items-center justify-between mb-3 xs:mb-4">
                    <h3 class="font-bold text-white flex items-center gap-2 text-sm xs:text-base">
                        <i class="fa-solid fa-chart-line text-pink-400"></i>
                        Alerta Distribui√ß√£o
                    </h3>
                    <span class="text-[10px] xs:text-xs text-gray-400">Vender parcial</span>
                </div>
                <div id="distribution-list" class="space-y-2 xs:space-y-3">
                    <!-- Lista gerada dinamicamente -->
                </div>
            </div>
            
            <!-- Card 3: Holders em Destaque -->
            <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5 card-hold">
                <div class="flex items-center justify-between mb-3 xs:mb-4">
                    <h3 class="font-bold text-white flex items-center gap-2 text-sm xs:text-base">
                        <i class="fa-solid fa-hold text-yellow-400"></i>
                        Holders
                    </h3>
                    <span class="text-[10px] xs:text-xs text-gray-400">Manter</span>
                </div>
                <div id="hold-list" class="space-y-2 xs:space-y-3">
                    <!-- Lista gerada dinamicamente -->
                </div>
            </div>
        </section>
        
        <!-- Se√ß√£o 3: Cards de An√°lise Detalhada -->
        <section class="mb-6 xs:mb-8">
            <div class="flex flex-col xs:flex-row justify-between items-start xs:items-center mb-4 gap-3 xs:gap-0">
                <h2 class="text-lg xs:text-xl font-bold text-white flex items-center gap-2">
                    <i class="fa-solid fa-magnifying-glass-chart text-brand-500 text-base xs:text-lg"></i>
                    An√°lise por Ativo
                </h2>
                <div class="relative w-full xs:w-auto">
                    <input type="text" 
                           id="search-assets" 
                           placeholder="Buscar ativo (BTC, ETH...)" 
                           class="bg-dark-800 border border-gray-700 rounded-lg px-3 xs:px-4 py-2 xs:py-2 text-xs xs:text-sm focus:border-brand-500 outline-none w-full xs:w-64 touch-button">
                </div>
            </div>
            
            <div id="assets-grid" class="grid grid-cols-1 xs:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 xs:gap-6">
                <!-- Cards ser√£o gerados dinamicamente -->
            </div>
        </section>
        
        <!-- Se√ß√£o 4: M√©tricas de Mercado para HOLDERS -->
        <section class="mb-6 xs:mb-8">
            <h2 class="text-lg xs:text-xl font-bold text-white mb-4 flex items-center gap-2">
                <i class="fa-solid fa-chart-bar text-purple-500 text-base xs:text-lg"></i>
                M√©tricas de Mercado
            </h2>
            
            <div class="grid grid-cols-1 xs:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 xs:gap-4">
                <!-- M√©trica 1: Valuation Relativa -->
                <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-white text-sm xs:text-base">Valuation</h4>
                        <i class="fa-solid fa-scale-balanced text-blue-400"></i>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">P/S Ratio</span>
                            <span class="text-white font-mono">8.4</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">P/B Ratio</span>
                            <span class="text-white font-mono">3.2</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">NVT Ratio</span>
                            <span class="text-white font-mono">45.6</span>
                        </div>
                    </div>
                </div>
                
                <!-- M√©trica 2: Liquidez & Volume -->
                <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-white text-sm xs:text-base">Liquidez</h4>
                        <i class="fa-solid fa-water text-cyan-400"></i>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Volume / MCap</span>
                            <span class="text-white font-mono">3.8%</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Depth Score</span>
                            <span class="text-white font-mono">72</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Stablecoin</span>
                            <span class="text-white font-mono">28.5%</span>
                        </div>
                    </div>
                </div>
                
                <!-- M√©trica 3: Sentimento Holders -->
                <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-white text-sm xs:text-base">Sentimento</h4>
                        <i class="fa-solid fa-brain text-green-400"></i>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Conviction</span>
                            <span class="text-white font-mono">85%</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Supply Locked</span>
                            <span class="text-white font-mono">64.2%</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Hold Time</span>
                            <span class="text-white font-mono">128d</span>
                        </div>
                    </div>
                </div>
                
                <!-- M√©trica 4: Risco & Volatilidade -->
                <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-white text-sm xs:text-base">Risco</h4>
                        <i class="fa-solid fa-shield text-red-400"></i>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Sharpe Ratio</span>
                            <span class="text-white font-mono">1.8</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Max Drawdown</span>
                            <span class="text-white font-mono">-24.3%</span>
                        </div>
                        <div class="flex justify-between text-xs xs:text-sm">
                            <span class="text-gray-400">Volatility 30d</span>
                            <span class="text-white font-mono">68.4</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Se√ß√£o 5: Estrat√©gias de Acumula√ß√£o -->
        <section class="mb-6 xs:mb-8">
            <h2 class="text-lg xs:text-xl font-bold text-white mb-4 flex items-center gap-2">
                <i class="fa-solid fa-chess-board text-yellow-500 text-base xs:text-lg"></i>
                Estrat√©gias Sugeridas
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- Estrat√©gia 1: DCA Otimizado -->
                <div class="bg-gradient-to-br from-dark-800 to-dark-900 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-8 h-8 xs:w-10 xs:h-10 bg-blue-900/50 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-calendar-day text-blue-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-white text-sm xs:text-base">DCA Otimizado</h4>
                            <p class="text-[10px] xs:text-xs text-gray-400">Compra inteligente</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-xs xs:text-sm mb-1">
                                <span class="text-gray-400">Pr√≥xima compra</span>
                                <span class="text-blue-400">-12.4% ATH</span>
                            </div>
                            <div class="accumulation-progress">
                                <div class="accumulation-progress-fill" style="width: 65%"></div>
                            </div>
                        </div>
                        <button class="w-full bg-blue-600 hover:bg-blue-500 text-white py-2 xs:py-2 rounded-lg text-xs xs:text-sm font-semibold touch-button">
                            Configurar DCA
                        </button>
                    </div>
                </div>
                
                <!-- Estrat√©gia 2: Acumula√ß√£o em N√≠veis -->
                <div class="bg-gradient-to-br from-dark-800 to-dark-900 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-8 h-8 xs:w-10 xs:h-10 bg-green-900/50 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-layer-group text-green-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-white text-sm xs:text-base">Acumula√ß√£o N√≠veis</h4>
                            <p class="text-[10px] xs:text-xs text-gray-400">Suportes t√©cnicos</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="text-xs xs:text-sm text-gray-300">
                            <div class="flex justify-between mb-1">
                                <span>N√≠vel 1 (Fib)</span>
                                <span class="text-green-400">Ativo</span>
                            </div>
                            <div class="flex justify-between mb-1">
                                <span>N√≠vel 2 (SMA200)</span>
                                <span class="text-yellow-400">Pendente</span>
                            </div>
                            <div class="flex justify-between">
                                <span>N√≠vel 3 (ATL)</span>
                                <span class="text-red-400">Distante</span>
                            </div>
                        </div>
                        <button class="w-full bg-green-600 hover:bg-green-500 text-white py-2 xs:py-2 rounded-lg text-xs xs:text-sm font-semibold touch-button">
                            Definir N√≠veis
                        </button>
                    </div>
                </div>
                
                <!-- Estrat√©gia 3: Staking & Yield -->
                <div class="bg-gradient-to-br from-dark-800 to-dark-900 rounded-xl border border-gray-800 p-4 xs:p-5">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-8 h-8 xs:w-10 xs:h-10 bg-purple-900/50 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-coins text-purple-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-white text-sm xs:text-base">Staking & Yield</h4>
                            <p class="text-[10px] xs:text-xs text-gray-400">Renda passiva</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="grid grid-cols-2 gap-3 text-center">
                            <div class="bg-dark-800 rounded-lg p-2">
                                <div class="text-[10px] xs:text-xs text-gray-400">APY M√©dio</div>
                                <div class="text-base xs:text-lg font-bold text-white">8.4%</div>
                            </div>
                            <div class="bg-dark-800 rounded-lg p-2">
                                <div class="text-[10px] xs:text-xs text-gray-400">Risco</div>
                                <div class="text-base xs:text-lg font-bold text-yellow-400">Baixo</div>
                            </div>
                        </div>
                        <button class="w-full bg-purple-600 hover:bg-purple-500 text-white py-2 xs:py-2 rounded-lg text-xs xs:text-sm font-semibold touch-button">
                            Explorar Staking
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-dark-900 border-t border-gray-800 py-4 xs:py-6 mt-8 xs:mt-12">
        <div class="w-full mx-auto px-3 xs:px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 xs:mb-0 text-center md:text-left">
                    <div class="flex items-center gap-2 justify-center md:justify-start">
                        <div class="w-6 h-6 xs:w-8 xs:h-8 bg-gradient-to-br from-brand-600 to-blue-900 rounded-lg flex items-center justify-center">
                            <i class="fa-solid fa-diamond text-white text-xs xs:text-sm"></i>
                        </div>
                        <span class="font-bold text-white text-sm xs:text-base">CryptoPanel<span class="text-brand-500">HOLDER</span></span>
                    </div>
                    <p class="text-[10px] xs:text-xs text-gray-500 mt-1 xs:mt-2">Sistema para investidores de longo prazo</p>
                </div>
                
                <div class="flex gap-4 xs:gap-6">
                    <div class="text-center">
                        <div class="text-[10px] xs:text-xs text-gray-400">Ativos</div>
                        <div class="text-base xs:text-lg font-bold text-white" id="total-assets">24</div>
                    </div>
                    <div class="text-center">
                        <div class="text-[10px] xs:text-xs text-gray-400">Score</div>
                        <div class="text-base xs:text-lg font-bold text-green-400" id="avg-score">68.4</div>
                    </div>
                    <div class="text-center">
                        <div class="text-[10px] xs:text-xs text-gray-400">Atualizado</div>
                        <div class="text-base xs:text-lg font-bold text-white" id="last-update">--:--</div>
                    </div>
                </div>
            </div>
            
            <div class="text-center text-[10px] xs:text-xs text-gray-600 mt-4 xs:mt-6 pt-4 xs:pt-6 border-t border-gray-800">
                <p>¬© 2024 CryptoPanel HOLDER. Para fins educacionais.</p>
                <p class="mt-0.5 xs:mt-1">N√£o √© recomenda√ß√£o de investimento.</p>
            </div>
        </div>
    </footer>

    <!-- Modais -->
    <div id="asset-detail-modal" class="fixed inset-0 z-50 hidden bg-black/80 backdrop-blur-sm flex items-center justify-center p-3 xs:p-4">
        <div class="bg-dark-900 rounded-xl border border-gray-800 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <!-- Conte√∫do ser√° preenchido dinamicamente -->
        </div>
    </div>

    <div id="settings-modal" class="fixed inset-0 z-50 hidden bg-black/80 backdrop-blur-sm flex items-center justify-center p-3 xs:p-4">
        <div class="bg-dark-900 rounded-xl border border-gray-800 w-full max-w-2xl">
            <!-- Configura√ß√µes -->
        </div>
    </div>

    <!-- Template para Card de Ativo -->
    <template id="asset-card-template">
        <div class="bg-dark-900/50 rounded-xl border border-gray-800 p-3 xs:p-4 hover:border-brand-500 transition-colors cursor-pointer asset-card" data-symbol="">
            <div class="flex justify-between items-start mb-3">
                <div class="flex items-center gap-2 xs:gap-3">
                    <div class="relative">
                        <div class="w-10 h-10 xs:w-12 xs:h-12 rounded-full flex items-center justify-center text-white font-bold holder-score-badge text-sm xs:text-base">
                            --
                        </div>
                    </div>
                    <div>
                        <h4 class="font-bold text-white text-base xs:text-lg asset-symbol">BTC</h4>
                        <div class="flex items-center gap-2 mt-0.5 xs:mt-1">
                            <span class="text-[10px] xs:text-xs px-1.5 xs:px-2 py-0.5 xs:py-1 rounded bg-gray-800 text-gray-400 asset-category">Layer 1</span>
                            <span class="text-[10px] xs:text-xs text-gray-500">#<span class="asset-rank">1</span></span>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-lg xs:text-xl font-bold text-white asset-price">$0.00</div>
                    <div class="text-xs xs:text-sm asset-change">0.00%</div>
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-2 xs:gap-3 mb-3 xs:mb-4">
                <div class="bg-dark-800 rounded-lg p-2">
                    <div class="text-[10px] xs:text-xs text-gray-400 mb-0.5 xs:mb-1">RSI (14d)</div>
                    <div class="text-xs xs:text-sm font-bold asset-rsi">--</div>
                </div>
                <div class="bg-dark-800 rounded-lg p-2">
                    <div class="text-[10px] xs:text-xs text-gray-400 mb-0.5 xs:mb-1">Volume</div>
                    <div class="text-xs xs:text-sm font-bold asset-volume-ratio">--</div>
                </div>
                <div class="bg-dark-800 rounded-lg p-2">
                    <div class="text-[10px] xs:text-xs text-gray-400 mb-0.5 xs:mb-1">Market Cap</div>
                    <div class="text-xs xs:text-sm font-bold asset-market-cap">--</div>
                </div>
                <div class="bg-dark-800 rounded-lg p-2">
                    <div class="text-[10px] xs:text-xs text-gray-400 mb-0.5 xs:mb-1">Dist. ATH</div>
                    <div class="text-xs xs:text-sm font-bold asset-ath-distance">--</div>
                </div>
            </div>
            
            <div class="mb-3">
                <div class="flex justify-between text-[10px] xs:text-xs text-gray-400 mb-0.5 xs:mb-1">
                    <span>Progresso</span>
                    <span class="asset-accumulation-progress-text">0%</span>
                </div>
                <div class="accumulation-progress">
                    <div class="accumulation-progress-fill asset-accumulation-progress-bar" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="flex gap-2">
                <button class="flex-1 bg-green-600 hover:bg-green-500 text-white py-2 xs:py-2 rounded-lg text-xs xs:text-sm font-semibold transition-colors touch-button">
                    <i class="fa-solid fa-plus mr-1"></i>Acumular
                </button>
                <button class="flex-1 bg-blue-600 hover:bg-blue-500 text-white py-2 xs:py-2 rounded-lg text-xs xs:text-sm font-semibold transition-colors touch-button">
                    <i class="fa-solid fa-chart-line mr-1"></i>Analisar
                </button>
            </div>
        </div>
    </template>

    <!-- Script Principal Corrigido -->
    <script>
        // Sistema CryptoPanel HOLDER
        const HolderSystem = {
            // Configura√ß√µes
            config: {
                api: {
                    binance: 'https://api.binance.com/api/v3',
                    coinGecko: 'https://api.coingecko.com/api/v3',
                    fearGreed: 'https://api.alternative.me/fng'
                },
                refreshInterval: 30000, // 30 segundos
                defaultTokens: ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT', 'ADAUSDT', 'XRPUSDT', 'DOTUSDT', 'AVAXUSDT', 'MATICUSDT', 'LINKUSDT',
                               'DOGEUSDT', 'SHIBUSDT', 'TRXUSDT', 'UNIUSDT', 'ATOMUSDT', 'ETCUSDT', 'FILUSDT', 'LTCUSDT', 'NEARUSDT', 'ALGOUSDT']
            },
            
            // Estado do Sistema
            state: {
                tokens: JSON.parse(localStorage.getItem('holder_tokens')) || this.config.defaultTokens,
                watchlist: JSON.parse(localStorage.getItem('holder_watchlist')) || [],
                alerts: JSON.parse(localStorage.getItem('holder_alerts')) || [],
                strategies: JSON.parse(localStorage.getItem('holder_strategies')) || [],
                marketData: {},
                holderScores: {},
                lastUpdate: null,
                wsConnection: null,
                isLoading: false
            },
            
            // Inicializa√ß√£o
            async init() {
                console.log('üöÄ Inicializando CryptoPanel HOLDER...');
                
                // Mostrar loading
                this.showLoading();
                
                // Carregar dados iniciais
                await this.loadMarketData();
                await this.calculateHolderScores();
                
                // Inicializar UI
                this.renderRanking();
                this.renderDashboardLists();
                this.renderAssetCards();
                this.renderDashboardMetrics();
                
                // Configurar atualiza√ß√µes autom√°ticas
                this.setupAutoRefresh();
                
                // Configurar WebSocket (opcional)
                // this.setupWebSocket();
                
                // Atualizar timestamp
                this.updateLastUpdate();
                
                // Configurar event listeners
                this.setupEventListeners();
                
                // Esconder loading
                this.hideLoading();
            },
            
            // Carregar dados de mercado
            async loadMarketData() {
                this.state.isLoading = true;
                try {
                    const batchSize = 5;
                    const batches = [];
                    
                    // Dividir tokens em lotes para evitar sobrecarga
                    for (let i = 0; i < this.state.tokens.length; i += batchSize) {
                        const batch = this.state.tokens.slice(i, i + batchSize);
                        batches.push(batch);
                    }
                    
                    // Processar cada lote
                    for (const batch of batches) {
                        const promises = batch.map(async (symbol) => {
                            try {
                                const [tickerData] = await Promise.all([
                                    this.fetchBinanceTicker(symbol),
                                    // Desabilitar klines e depth inicialmente para performance
                                    // this.fetchBinanceKlines(symbol, '1d', 30),
                                    // this.fetchBinanceDepth(symbol)
                                ]);
                                
                                return { symbol, tickerData, success: true };
                            } catch (error) {
                                console.error(`Erro ao buscar ${symbol}:`, error);
                                return { symbol, error: error.message, success: false };
                            }
                        });
                        
                        const results = await Promise.all(promises);
                        
                        // Processar resultados bem-sucedidos
                        results.forEach(result => {
                            if (result.success && result.tickerData) {
                                this.state.marketData[result.symbol] = {
                                    ...result.tickerData,
                                    timestamp: Date.now()
                                };
                            }
                        });
                        
                        // Pequena pausa entre lotes
                        await new Promise(resolve => setTimeout(resolve, 500));
                    }
                    
                    console.log('‚úÖ Dados de mercado carregados:', Object.keys(this.state.marketData).length, 'ativos');
                    return true;
                } catch (error) {
                    console.error('‚ùå Erro ao carregar dados:', error);
                    
                    // Carregar dados de fallback
                    await this.loadFallbackData();
                    return false;
                } finally {
                    this.state.isLoading = false;
                }
            },
            
            // Dados de fallback para demonstra√ß√£o
            async loadFallbackData() {
                console.log('üìã Carregando dados de demonstra√ß√£o...');
                
                const demoData = {
                    'BTCUSDT': {
                        symbol: 'BTCUSDT',
                        lastPrice: '45000.50',
                        priceChangePercent: '2.5',
                        volume: '25000',
                        quoteVolume: '1125000000',
                        highPrice: '45500',
                        lowPrice: '44500',
                        timestamp: Date.now()
                    },
                    'ETHUSDT': {
                        symbol: 'ETHUSDT',
                        lastPrice: '2500.75',
                        priceChangePercent: '1.8',
                        volume: '15000',
                        quoteVolume: '37500000',
                        highPrice: '2550',
                        lowPrice: '2450',
                        timestamp: Date.now()
                    },
                    'BNBUSDT': {
                        symbol: 'BNBUSDT',
                        lastPrice: '320.25',
                        priceChangePercent: '3.2',
                        volume: '5000',
                        quoteVolume: '1600000',
                        highPrice: '325',
                        lowPrice: '315',
                        timestamp: Date.now()
                    },
                    'SOLUSDT': {
                        symbol: 'SOLUSDT',
                        lastPrice: '95.80',
                        priceChangePercent: '5.5',
                        volume: '8000',
                        quoteVolume: '766400',
                        highPrice: '98',
                        lowPrice: '92',
                        timestamp: Date.now()
                    },
                    'ADAUSDT': {
                        symbol: 'ADAUSDT',
                        lastPrice: '0.45',
                        priceChangePercent: '-1.2',
                        volume: '12000',
                        quoteVolume: '5400',
                        highPrice: '0.46',
                        lowPrice: '0.44',
                        timestamp: Date.now()
                    }
                };
                
                // Adicionar dados de demonstra√ß√£o
                Object.assign(this.state.marketData, demoData);
            },
            
            // Calcular scores HOLDER
            async calculateHolderScores() {
                for (const symbol of this.state.tokens) {
                    const data = this.state.marketData[symbol];
                    if (!data) continue;
                    
                    const score = await this.calculateHolderScore(symbol, data);
                    this.state.holderScores[symbol] = score;
                }
                
                // Salvar scores
                localStorage.setItem('holder_scores', JSON.stringify(this.state.holderScores));
            },
            
            // Algoritmo de Score HOLDER (simplificado para demo)
            async calculateHolderScore(symbol, marketData) {
                // Fatores simplificados para demonstra√ß√£o
                const baseScore = 50;
                
                // Ajustar baseado na varia√ß√£o de pre√ßo
                const change = parseFloat(marketData.priceChangePercent) || 0;
                let changeScore = 0;
                
                if (change < -20) changeScore = 85; // Muito oversold - √≥timo para compra
                else if (change < -10) changeScore = 75; // Oversold - bom para compra
                else if (change < 0) changeScore = 60; // Leve queda - oportunidade
                else if (change < 10) changeScore = 50; // Neutro
                else if (change < 20) changeScore = 40; // Alta moderada
                else if (change < 30) changeScore = 30; // Alta significativa
                else changeScore = 20; // Muito alta - cuidado
                
                // Ajustar baseado no volume (simplificado)
                const volume = parseFloat(marketData.volume) || 0;
                let volumeScore = 50;
                
                if (volume > 10000) volumeScore = 70; // Alto volume - boa liquidez
                else if (volume > 5000) volumeScore = 60;
                else if (volume > 1000) volumeScore = 50;
                else volumeScore = 40; // Baixo volume
                
                // Score final (m√©dia ponderada)
                const finalScore = Math.round((changeScore * 0.7) + (volumeScore * 0.3));
                
                return {
                    score: Math.min(100, Math.max(0, finalScore)),
                    breakdown: {
                        priceChange: changeScore,
                        volume: volumeScore
                    },
                    recommendation: this.getRecommendation(finalScore),
                    timestamp: Date.now()
                };
            },
            
            getRecommendation(score) {
                if (score >= 75) return {
                    action: 'ACCUMULATE',
                    color: 'var(--color-accumulate)',
                    icon: 'fa-plus',
                    description: 'Forte oportunidade de acumula√ß√£o'
                };
                if (score >= 60) return {
                    action: 'BUY',
                    color: 'var(--color-buy)',
                    icon: 'fa-arrow-up',
                    description: 'Boa oportunidade de compra'
                };
                if (score >= 40) return {
                    action: 'HOLD',
                    color: 'var(--color-hold)',
                    icon: 'fa-hold',
                    description: 'Manter posi√ß√£o atual'
                };
                if (score >= 25) return {
                    action: 'REDUCE',
                    color: 'var(--color-distribute)',
                    icon: 'fa-minus',
                    description: 'Considerar redu√ß√£o parcial'
                };
                return {
                    action: 'SELL',
                    color: 'var(--color-sell)',
                    icon: 'fa-arrow-down',
                    description: 'Considerar venda'
                };
            },
            
            // APIs
            async fetchBinanceTicker(symbol) {
                try {
                    const response = await fetch(`${this.config.api.binance}/ticker/24hr?symbol=${symbol}`);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return await response.json();
                } catch (error) {
                    console.warn(`‚ö†Ô∏è Erro ao buscar ticker ${symbol}:`, error.message);
                    throw error;
                }
            },
            
            async fetchBinanceKlines(symbol, interval, limit) {
                try {
                    const response = await fetch(
                        `${this.config.api.binance}/klines?symbol=${symbol}&interval=${interval}&limit=${limit}`
                    );
                    return await response.json();
                } catch (error) {
                    console.error(`Erro ao buscar klines ${symbol}:`, error);
                    return [];
                }
            },
            
            async fetchBinanceDepth(symbol) {
                try {
                    const response = await fetch(`${this.config.api.binance}/depth?symbol=${symbol}&limit=20`);
                    return await response.json();
                } catch (error) {
                    console.error(`Erro ao buscar depth ${symbol}:`, error);
                    return { bids: [], asks: [] };
                }
            },
            
            // UI Methods
            renderRanking() {
                const tbody = document.getElementById('holder-ranking');
                if (!tbody) return;
                
                // Ordenar tokens por score
                const sortedTokens = this.getSortedTokens();
                
                // Se n√£o houver dados, mostrar mensagem
                if (sortedTokens.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="10" class="p-4 text-center text-gray-500">
                                <div class="flex flex-col items-center justify-center py-8">
                                    <i class="fa-solid fa-spinner fa-spin text-2xl text-brand-500 mb-3"></i>
                                    <p>Carregando dados de criptomoedas...</p>
                                    <p class="text-sm text-gray-400 mt-2">Isso pode levar alguns segundos</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                tbody.innerHTML = sortedTokens.map((item, index) => {
                    const data = item.data;
                    const score = item.score;
                    const recommendation = this.getRecommendation(score);
                    
                    // Formatar s√≠mbolo para exibi√ß√£o
                    const displaySymbol = item.symbol.replace('USDT', '');
                    
                    return `
                        <tr class="hover:bg-white/5 transition-colors">
                            <td class="p-2 xs:p-4 font-bold text-gray-400">${index + 1}</td>
                            <td class="p-2 xs:p-4">
                                <div class="flex items-center gap-2 xs:gap-3">
                                    <div class="w-6 h-6 xs:w-8 xs:h-8 rounded-full flex items-center justify-center text-white font-bold text-xs xs:text-sm" 
                                         style="background: ${recommendation.color}">
                                        ${score}
                                    </div>
                                    <div>
                                        <div class="font-bold text-white text-sm xs:text-base">${displaySymbol}</div>
                                        <div class="text-[10px] xs:text-xs text-gray-500">${item.symbol}</div>
                                    </div>
                                </div>
                            </td>
                            <td class="p-2 xs:p-4 text-right font-mono text-white text-sm xs:text-base mobile-hidden sm:table-cell">
                                ${this.formatPrice(parseFloat(data.lastPrice))}
                            </td>
                            <td class="p-2 xs:p-4 text-center">
                                <div class="inline-flex items-center gap-1 xs:gap-2">
                                    <div class="text-sm xs:text-lg font-bold" style="color: ${recommendation.color}">
                                        ${score}
                                    </div>
                                    <div class="text-[10px] xs:text-xs px-1.5 xs:px-2 py-0.5 xs:py-1 rounded" style="background: ${recommendation.color}20; color: ${recommendation.color}">
                                        ${recommendation.action}
                                    </div>
                                </div>
                            </td>
                            <td class="p-2 xs:p-4 text-center font-mono text-sm mobile-hidden md:table-cell">
                                ${this.calculateRSI(data)}
                            </td>
                            <td class="p-2 xs:p-4 text-center mobile-hidden lg:table-cell">
                                <div class="flex flex-col items-center">
                                    <div class="text-xs xs:text-sm font-mono">${this.formatVolume(data.volume)}</div>
                                    <div class="volume-bar" style="width: 40px xs:60px"></div>
                                </div>
                            </td>
                            <td class="p-2 xs:p-4 text-center mobile-hidden lg:table-cell">
                                <span class="font-mono text-sm ${parseFloat(data.priceChangePercent) < 0 ? 'text-red-400' : 'text-green-400'}">
                                    ${data.priceChangePercent}%
                                </span>
                            </td>
                            <td class="p-2 xs:p-4 text-center font-mono text-xs xs:text-sm mobile-hidden md:table-cell">
                                ${this.formatMarketCap(parseFloat(data.quoteVolume))}
                            </td>
                            <td class="p-2 xs:p-4 text-center">
                                <div class="inline-flex items-center gap-1 xs:gap-2">
                                    <i class="fa-solid ${recommendation.icon} text-xs xs:text-sm" style="color: ${recommendation.color}"></i>
                                    <span class="text-xs xs:text-sm" style="color: ${recommendation.color}">
                                        ${recommendation.action}
                                    </span>
                                </div>
                            </td>
                            <td class="p-2 xs:p-4 text-right">
                                <button onclick="HolderUI.showAssetDetail('${item.symbol}')" 
                                        class="px-2 xs:px-3 py-1 xs:py-1 bg-brand-600 hover:bg-brand-500 rounded-lg text-xs xs:text-sm text-white transition-colors touch-button">
                                    <i class="fa-solid fa-chart-line mr-0.5 xs:mr-1"></i><span class="mobile-hidden xs:inline">Detalhes</span>
                                </button>
                            </td>
                        </tr>
                    `;
                }).join('');
            },
            
            // Renderizar listas do dashboard
            renderDashboardLists() {
                this.renderAccumulationList();
                this.renderDistributionList();
                this.renderHoldList();
            },
            
            renderAccumulationList() {
                const container = document.getElementById('accumulation-list');
                if (!container) return;
                
                const sortedTokens = this.getSortedTokens()
                    .filter(item => item.score >= 70)
                    .slice(0, 3);
                
                if (sortedTokens.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-4 text-gray-500 text-xs xs:text-sm">
                            <i class="fa-solid fa-search mb-2"></i>
                            <p>Nenhuma oportunidade de acumula√ß√£o no momento</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = sortedTokens.map(item => {
                    const symbol = item.symbol.replace('USDT', '');
                    const price = parseFloat(item.data.lastPrice);
                    const change = parseFloat(item.data.priceChangePercent);
                    
                    return `
                        <div class="flex items-center justify-between p-2 xs:p-3 bg-dark-800/50 rounded-lg">
                            <div class="flex items-center gap-2 xs:gap-3">
                                <div class="w-6 h-6 xs:w-8 xs:h-8 rounded-full bg-green-500/20 flex items-center justify-center">
                                    <span class="text-xs xs:text-sm font-bold text-green-400">${item.score}</span>
                                </div>
                                <div>
                                    <div class="font-semibold text-white text-sm xs:text-base">${symbol}</div>
                                    <div class="text-[10px] xs:text-xs text-gray-400">${this.formatPrice(price)}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs xs:text-sm font-bold ${change >= 0 ? 'text-green-400' : 'text-red-400'}">
                                    ${change >= 0 ? '+' : ''}${change.toFixed(2)}%
                                </div>
                                <div class="text-[10px] xs:text-xs text-gray-400">24h</div>
                            </div>
                        </div>
                    `;
                }).join('');
            },
            
            renderDistributionList() {
                const container = document.getElementById('distribution-list');
                if (!container) return;
                
                const sortedTokens = this.getSortedTokens()
                    .filter(item => item.score < 25)
                    .slice(0, 3);
                
                if (sortedTokens.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-4 text-gray-500 text-xs xs:text-sm">
                            <i class="fa-solid fa-check mb-2"></i>
                            <p>Nenhum alerta de distribui√ß√£o</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = sortedTokens.map(item => {
                    const symbol = item.symbol.replace('USDT', '');
                    const price = parseFloat(item.data.lastPrice);
                    const change = parseFloat(item.data.priceChangePercent);
                    
                    return `
                        <div class="flex items-center justify-between p-2 xs:p-3 bg-dark-800/50 rounded-lg">
                            <div class="flex items-center gap-2 xs:gap-3">
                                <div class="w-6 h-6 xs:w-8 xs:h-8 rounded-full bg-pink-500/20 flex items-center justify-center">
                                    <span class="text-xs xs:text-sm font-bold text-pink-400">${item.score}</span>
                                </div>
                                <div>
                                    <div class="font-semibold text-white text-sm xs:text-base">${symbol}</div>
                                    <div class="text-[10px] xs:text-xs text-gray-400">${this.formatPrice(price)}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs xs:text-sm font-bold ${change >= 0 ? 'text-green-400' : 'text-red-400'}">
                                    ${change >= 0 ? '+' : ''}${change.toFixed(2)}%
                                </div>
                                <div class="text-[10px] xs:text-xs text-gray-400">24h</div>
                            </div>
                        </div>
                    `;
                }).join('');
            },
            
            renderHoldList() {
                const container = document.getElementById('hold-list');
                if (!container) return;
                
                const sortedTokens = this.getSortedTokens()
                    .filter(item => item.score >= 40 && item.score < 60)
                    .slice(0, 3);
                
                if (sortedTokens.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-4 text-gray-500 text-xs xs:text-sm">
                            <i class="fa-solid fa-pause mb-2"></i>
                            <p>Nenhum ativo em destaque para hold</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = sortedTokens.map(item => {
                    const symbol = item.symbol.replace('USDT', '');
                    const price = parseFloat(item.data.lastPrice);
                    const change = parseFloat(item.data.priceChangePercent);
                    
                    return `
                        <div class="flex items-center justify-between p-2 xs:p-3 bg-dark-800/50 rounded-lg">
                            <div class="flex items-center gap-2 xs:gap-3">
                                <div class="w-6 h-6 xs:w-8 xs:h-8 rounded-full bg-yellow-500/20 flex items-center justify-center">
                                    <span class="text-xs xs:text-sm font-bold text-yellow-400">${item.score}</span>
                                </div>
                                <div>
                                    <div class="font-semibold text-white text-sm xs:text-base">${symbol}</div>
                                    <div class="text-[10px] xs:text-xs text-gray-400">${this.formatPrice(price)}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs xs:text-sm font-bold ${change >= 0 ? 'text-green-400' : 'text-red-400'}">
                                    ${change >= 0 ? '+' : ''}${change.toFixed(2)}%
                                </div>
                                <div class="text-[10px] xs:text-xs text-gray-400">24h</div>
                            </div>
                        </div>
                    `;
                }).join('');
            },
            
            renderAssetCards() {
                const grid = document.getElementById('assets-grid');
                if (!grid) return;
                
                // Ordenar por score
                const sortedTokens = this.getSortedTokens();
                
                // Se n√£o houver dados, mostrar skeleton
                if (sortedTokens.length === 0) {
                    grid.innerHTML = `
                        <div class="col-span-full text-center py-8 text-gray-500">
                            <i class="fa-solid fa-spinner fa-spin text-2xl text-brand-500 mb-3"></i>
                            <p>Carregando criptomoedas...</p>
                        </div>
                    `;
                    return;
                }
                
                grid.innerHTML = sortedTokens.map((item, index) => {
                    const template = document.getElementById('asset-card-template').content.cloneNode(true);
                    const card = template.querySelector('.asset-card');
                    
                    // Preencher dados
                    const symbol = item.symbol.replace('USDT', '');
                    card.querySelector('.asset-symbol').textContent = symbol;
                    card.querySelector('.asset-rank').textContent = index + 1;
                    card.querySelector('.asset-price').textContent = this.formatPrice(parseFloat(item.data.lastPrice));
                    
                    const change = parseFloat(item.data.priceChangePercent);
                    const changeElement = card.querySelector('.asset-change');
                    changeElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                    changeElement.className = `text-xs xs:text-sm ${change >= 0 ? 'text-green-400' : 'text-red-400'}`;
                    
                    // Score
                    const scoreElement = card.querySelector('.holder-score-badge');
                    scoreElement.textContent = item.score;
                    const recommendation = this.getRecommendation(item.score);
                    scoreElement.style.background = recommendation.color;
                    
                    // RSI (simulado)
                    const rsi = this.calculateRSI(item.data);
                    card.querySelector('.asset-rsi').textContent = rsi;
                    card.querySelector('.asset-rsi').style.color = 
                        rsi < 30 ? '#10b981' : rsi > 70 ? '#ef4444' : '#f59e0b';
                    
                    // Volume ratio
                    const volumeRatio = ((parseFloat(item.data.volume) || 1) / 1000).toFixed(1);
                    card.querySelector('.asset-volume-ratio').textContent = `${volumeRatio}K`;
                    
                    // Market Cap
                    card.querySelector('.asset-market-cap').textContent = 
                        this.formatMarketCap(parseFloat(item.data.quoteVolume || item.data.lastPrice * 1000));
                    
                    // ATH distance (simulado)
                    const athDistance = Math.abs(change).toFixed(1);
                    card.querySelector('.asset-ath-distance').textContent = `${athDistance}%`;
                    card.querySelector('.asset-ath-distance').style.color = 
                        change < 0 ? '#10b981' : '#ef4444';
                    
                    // Progresso de acumula√ß√£o (baseado no score)
                    const progress = item.score;
                    card.querySelector('.asset-accumulation-progress-text').textContent = `${progress}%`;
                    card.querySelector('.asset-accumulation-progress-bar').style.width = `${progress}%`;
                    
                    // Event listeners
                    card.addEventListener('click', () => HolderUI.showAssetDetail(item.symbol));
                    
                    return card.outerHTML;
                }).join('');
            },
            
            renderDashboardMetrics() {
                // Atualizar m√©tricas do dashboard
                const totalAssets = document.getElementById('total-assets');
                const avgScore = document.getElementById('avg-score');
                
                if (totalAssets) totalAssets.textContent = Object.keys(this.state.marketData).length || 0;
                
                if (avgScore) {
                    const scores = Object.values(this.state.holderScores)
                        .map(s => s.score)
                        .filter(s => s > 0);
                    
                    const average = scores.length > 0 ? 
                        (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(1) : '0.0';
                    
                    avgScore.textContent = average;
                    
                    // Colorir baseado no score
                    if (parseFloat(average) >= 70) avgScore.className = 'text-base xs:text-lg font-bold text-green-400';
                    else if (parseFloat(average) >= 50) avgScore.className = 'text-base xs:text-lg font-bold text-yellow-400';
                    else avgScore.className = 'text-base xs:text-lg font-bold text-red-400';
                }
            },
            
            // Utilit√°rios
            getSortedTokens() {
                return this.state.tokens
                    .map(symbol => ({
                        symbol,
                        data: this.state.marketData[symbol],
                        score: this.state.holderScores[symbol]?.score || 0
                    }))
                    .filter(item => item.data)
                    .sort((a, b) => b.score - a.score);
            },
            
            formatPrice(value) {
                if (value >= 1000) return `$${value.toLocaleString('en-US', { maximumFractionDigits: 0 })}`;
                if (value >= 1) return `$${value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                return `$${value.toLocaleString('en-US', { minimumFractionDigits: 4, maximumFractionDigits: 6 })}`;
            },
            
            formatMarketCap(value) {
                if (!value || value < 1000) return '$0';
                if (value >= 1e12) return `$${(value / 1e12).toFixed(2)}T`;
                if (value >= 1e9) return `$${(value / 1e9).toFixed(2)}B`;
                if (value >= 1e6) return `$${(value / 1e6).toFixed(2)}M`;
                return `$${(value / 1e3).toFixed(1)}K`;
            },
            
            formatVolume(value) {
                const num = parseFloat(value) || 0;
                if (num >= 1e9) return `${(num / 1e9).toFixed(1)}B`;
                if (num >= 1e6) return `${(num / 1e6).toFixed(1)}M`;
                if (num >= 1e3) return `${(num / 1e3).toFixed(1)}K`;
                return num.toFixed(0);
            },
            
            calculateRSI(data) {
                // Implementa√ß√£o simplificada do RSI
                const change = parseFloat(data.priceChangePercent) || 0;
                if (change < -20) return 25; // Muito oversold
                if (change < -10) return 35; // Oversold
                if (change < 10) return 50; // Neutro
                if (change < 20) return 65; // Overbought
                return 75; // Muito overbought
            },
            
            updateLastUpdate() {
                const element = document.getElementById('last-update');
                if (element) {
                    const now = new Date();
                    element.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                }
            },
            
            setupAutoRefresh() {
                setInterval(async () => {
                    if (this.state.isLoading) return;
                    
                    console.log('üîÑ Atualizando dados...');
                    await this.loadMarketData();
                    await this.calculateHolderScores();
                    this.renderRanking();
                    this.renderDashboardLists();
                    this.renderAssetCards();
                    this.renderDashboardMetrics();
                    this.updateLastUpdate();
                }, this.config.refreshInterval);
            },
            
            setupWebSocket() {
                // Implementa√ß√£o opcional - comentada para performance
                /*
                try {
                    const ws = new WebSocket('wss://stream.binance.com:9443/ws/!ticker@arr');
                    
                    ws.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.processWebSocketData(data);
                    };
                    
                    ws.onerror = (error) => {
                        console.error('WebSocket error:', error);
                    };
                    
                    this.state.wsConnection = ws;
                } catch (error) {
                    console.error('Erro ao conectar WebSocket:', error);
                }
                */
            },
            
            processWebSocketData(data) {
                // Processar atualiza√ß√µes em tempo real
                data.forEach(ticker => {
                    const symbol = ticker.s;
                    if (this.state.tokens.includes(symbol)) {
                        // Atualizar dados em tempo real
                        if (this.state.marketData[symbol]) {
                            this.state.marketData[symbol].lastPrice = ticker.c;
                            this.state.marketData[symbol].priceChangePercent = ticker.P;
                            this.state.marketData[symbol].volume = ticker.v;
                            
                            // Atualizar UI
                            this.updateAssetUI(symbol);
                        }
                    }
                });
            },
            
            updateAssetUI(symbol) {
                // Atualizar elementos da UI para um s√≠mbolo espec√≠fico
                const priceElements = document.querySelectorAll(`[data-symbol="${symbol}"] .asset-price`);
                priceElements.forEach(el => {
                    const data = this.state.marketData[symbol];
                    if (data) {
                        el.textContent = this.formatPrice(parseFloat(data.lastPrice));
                    }
                });
            },
            
            setupEventListeners() {
                // Search
                const searchInput = document.getElementById('search-assets');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        const term = e.target.value.toUpperCase();
                        document.querySelectorAll('.asset-card').forEach(card => {
                            const symbol = card.dataset.symbol || '';
                            const displaySymbol = symbol.replace('USDT', '');
                            card.style.display = displaySymbol.includes(term) || symbol.includes(term) ? 'block' : 'none';
                        });
                    });
                }
                
                // Refresh button
                const refreshBtn = document.getElementById('refreshData');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', async () => {
                        refreshBtn.classList.add('animate-spin');
                        refreshBtn.disabled = true;
                        
                        await this.loadMarketData();
                        await this.calculateHolderScores();
                        this.renderRanking();
                        this.renderDashboardLists();
                        this.renderAssetCards();
                        this.renderDashboardMetrics();
                        
                        setTimeout(() => {
                            refreshBtn.classList.remove('animate-spin');
                            refreshBtn.disabled = false;
                        }, 1000);
                    });
                }
                
                // Touch/click optimizations
                document.querySelectorAll('.touch-button').forEach(btn => {
                    btn.addEventListener('touchstart', () => {
                        btn.style.transform = 'scale(0.98)';
                    });
                    
                    btn.addEventListener('touchend', () => {
                        btn.style.transform = '';
                    });
                });
            },
            
            showLoading() {
                // Adicionar overlay de loading se necess√°rio
                const loadingEl = document.createElement('div');
                loadingEl.id = 'holder-loading';
                loadingEl.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50';
                loadingEl.innerHTML = `
                    <div class="bg-dark-900 rounded-xl p-6 border border-gray-800 flex flex-col items-center">
                        <i class="fa-solid fa-spinner fa-spin text-3xl text-brand-500 mb-3"></i>
                        <p class="text-white">Carregando CryptoPanel HOLDER...</p>
                    </div>
                `;
                document.body.appendChild(loadingEl);
            },
            
            hideLoading() {
                const loadingEl = document.getElementById('holder-loading');
                if (loadingEl) {
                    loadingEl.remove();
                }
            }
        };
        
        // UI Controller
        const HolderUI = {
            showAssetDetail(symbol) {
                // Implementar modal de detalhes do ativo
                console.log('Mostrar detalhes:', symbol);
                alert(`Detalhes de ${symbol}\n\nEm uma implementa√ß√£o completa, aqui seria exibido um modal com gr√°ficos detalhados, an√°lises t√©cnicas, e op√ß√µes de configura√ß√£o.`);
            },
            
            openSettings() {
                // Implementar modal de configura√ß√µes
                alert('Configura√ß√µes\n\nAqui voc√™ pode configurar:\n- Lista de ativos monitorados\n- Alertas de pre√ßo\n- Estrat√©gias personalizadas\n- Prefer√™ncias de exibi√ß√£o');
            }
        };
        
        // Export Controller
        const HolderExport = {
            generateReport() {
                // Gerar relat√≥rio Excel
                const data = [];
                
                for (const symbol of HolderSystem.state.tokens) {
                    const marketData = HolderSystem.state.marketData[symbol];
                    const score = HolderSystem.state.holderScores[symbol];
                    
                    if (marketData && score) {
                        data.push({
                            Symbol: symbol,
                            Price: parseFloat(marketData.lastPrice),
                            '24h Change': parseFloat(marketData.priceChangePercent),
                            'Holder Score': score.score,
                            Recommendation: score.recommendation.action,
                            RSI: HolderSystem.calculateRSI(marketData),
                            Volume: parseFloat(marketData.volume),
                            'Quote Volume': parseFloat(marketData.quoteVolume),
                            Timestamp: new Date().toLocaleString()
                        });
                    }
                }
                
                // Se n√£o houver dados, usar dados de demonstra√ß√£o
                if (data.length === 0) {
                    data.push({
                        Symbol: 'BTCUSDT',
                        Price: 45000.50,
                        '24h Change': 2.5,
                        'Holder Score': 75,
                        Recommendation: 'ACCUMULATE',
                        RSI: 45,
                        Volume: 25000,
                        'Quote Volume': 1125000000,
                        Timestamp: new Date().toLocaleString()
                    });
                }
                
                // Criar worksheet
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Holder Report");
                
                // Gerar arquivo
                XLSX.writeFile(wb, `CryptoPanel_HOLDER_${new Date().toISOString().split('T')[0]}.xlsx`);
            }
        };
        
        // Inicializar sistema quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            HolderSystem.init();
            
            // Adicionar handler para redimensionamento da tela
            window.addEventListener('resize', () => {
                // Re-renderizar componentes sens√≠veis ao tamanho da tela
                HolderSystem.renderRanking();
            });
        });
        
        // Suporte para instala√ß√£o como PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
            });
        }
    </script>
</body>
</html>
